<?php
// This script and data application were generated by AppGini 5.75
// Download AppGini for free from https://bigprof.com/appgini/download/

	$currDir = dirname(__FILE__);
	include("$currDir/defaultLang.php");
	include("$currDir/language.php");
	include("$currDir/lib.php");

	handle_maintenance();

	header('Content-type: text/javascript; charset=' . datalist_db_encoding);

	$table_perms = getTablePermissions('formation_suivi');
	if(!$table_perms[0]){ die('// Access denied!'); }

	$mfk = $_GET['mfk'];
	$id = makeSafe($_GET['id']);
	$rnd1 = intval($_GET['rnd1']); if(!$rnd1) $rnd1 = '';

	if(!$mfk){
		die('// No js code available!');
	}

	switch($mfk){

		case 'competence_secondaire':
			if(!$id){
				?>
				$j('#competence_principale<?php echo $rnd1; ?>').html('&nbsp;');
				<?php
				break;
			}
			$res = sql("SELECT `competences_ref`.`id_competence` as 'id_competence', `competences_ref`.`titre_competence` as 'titre_competence', `competences_ref`.`description` as 'description', IF(    CHAR_LENGTH(`domaine1`.`titre_domaine`) || CHAR_LENGTH(`filiere1`.`titre_filiere`), CONCAT_WS('',   `domaine1`.`titre_domaine`, '>', `filiere1`.`titre_filiere`), '') as 'domaine_principal', `competences_ref`.`domaine` as 'domaine' FROM `competences_ref` LEFT JOIN `domaine` as domaine1 ON `domaine1`.`id_domaine`=`competences_ref`.`domaine_principal` LEFT JOIN `filiere` as filiere1 ON `filiere1`.`id_filiere`=`domaine1`.`rattache_a_filiere`  WHERE `competences_ref`.`id_competence`='{$id}' limit 1", $eo);
			$row = db_fetch_assoc($res);
			?>
			$j('#competence_principale<?php echo $rnd1; ?>').html('<?php echo addslashes(str_replace(array("\r", "\n"), '', nl2br($row['titre_competence'].' '.$row['domaine_principal']))); ?>&nbsp;');
			<?php
			break;


	}

?>